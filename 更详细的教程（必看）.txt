╔══════════════════════════════════════════════════╗
║                                                                                                                                          ║
║     SENTIENCE  v3.0                                                                                                        ║
║     让每个NPC都拥有AI大脑                                                                                            ║
║                                                                                                                                          ║
║     开发者：[某宇]                                                                                                            ║
║     硬件：GT730 + i5-10400                                                                                         ║
║                                                                                                                                          ║
╚══════════════════════════════════════════════════╝

=================================================
          安装前请仔细阅读每一步！
=================================================


【第1步】安装 Python（如果已安装请跳过）
─────────────────────────────────────────

1. 打开浏览器，访问：
   https://www.python.org/downloads/

2. 点击大黄按钮 "Download Python 3.x.x"

3. 运行下载的安装程序

4. ⚠️⚠️⚠️ 最重要的一步 ⚠️⚠️⚠️
   
   .exe安装界面底部有一个选项：
   ☐ Add Python to PATH
   
   你必须勾选它！！！变成：
   ☑ Add Python to PATH
   
   如果忘记勾选，Python将无法正常工作！

5. 点击 "Install Now" 等待安装完成

6. 验证安装：
   - 按 Win+R，输入 cmd，按回车
   - 输入：python --version
   - 如果显示 "Python 3.x.x" 就成功了


【第2步】安装 LM Studio
─────────────────────────────────────────

1. 打开浏览器，访问：
   https://lmstudio.ai/

2. 下载并安装 LM Studio

3. 打开 LM Studio

4. 导入AI模型（二选一）：

   方法A：使用我们提供的模型文件（推荐）
   ─────────────────────────────────────
   a. 打开文件夹：第3步_AI模型/LM_Studio_Model/
   b. 找到文件：qwen2.5-1.5b-instruct-q5_k_m.gguf
   c. 在LM Studio中，点击左侧 "My Models"
   d. 点击 "Import" 或直接把gguf文件
      拖拽到LM Studio窗口中
   e. 等待导入完成

   方法B：在线下载
   ─────────────────
   a. 在LM Studio搜索栏输入：qwen2.5-1.5b-instruct
   b. 选择 Q5_K_M 版本
   c. 点击下载（约1.1GB）

5. 加载模型：
   - 在LM Studio中选择已导入的模型
   - 点击 "Load Model"（加载模型）
   - 等待加载完成（需要约30秒）

6. 启动服务器：
   - 点击左侧 "Local Server" 图标
     
   - 点击 "Start stopped"
   - 你应该看到：
     "Server running "
     且变绿了
7. ⚠️ 每次玩游戏前都要：
   - 打开LM Studio
   - 加载模型
   - 启动服务器
   - 不要关闭LM Studio！


【第3步】安装 ScriptHookV（游戏模组框架）
─────────────────────────────────────────

如果你之前装过其他mod，可能已经有了。

1. 找到你的GTA V安装目录，例如：
   
   Steam版：
   C:\Program Files\Steam\steamapps\common\Grand Theft Auto V\
   
   Epic版：
   C:\Program Files\Epic Games\GTAV\
   
   其他：
   找到 GTA5.exe 所在的文件夹

2. 打开文件夹：第1步_前置工具/

3. 解压 ScriptHookV_x.x.x.zip

4. 将以下文件复制到GTA V根目录
   （就是GTA5.exe所在的文件夹）：
   
   ✅ ScriptHookV.dll
   ✅ dinput8.dll

5. 解压 ScriptHookVDotNet_x.x.zip

6. 将以下文件也复制到GTA V根目录：
   
   ✅ ScriptHookVDotNet.asi
   ✅ ScriptHookVDotNet2.dll
   ✅ ScriptHookVDotNet3.dll


【第4步】安装 AI NPC Mod
─────────────────────────────────────────

1. 在GTA V根目录中，找到 scripts 文件夹
   
   如果没有这个文件夹，自己创建一个：
   - 右键空白处 → 新建 → 文件夹
   - 命名为：scripts
   
   最终路径类似：
   C:\...\Grand Theft Auto V\scripts\

2. 打开文件夹：第2步_复制到GTA目录/scripts/

3. 将里面的所有文件复制到GTA V的scripts文件夹：
   
   ✅ SENTIENCE.dll
   ✅ Newtonsoft.Json.dll


【第5步】如果懒得话，一键安装Python依赖（一键安装）
─────────────────────────────────────────

1. 双击运行：一键安装依赖.bat（install_all.bat）

2. 等待安装完成
   （会自动安装语音合成和语音识别库）

3. 看到 "安装完成" 后按任意键关闭


【第6步】安装语音识别模型
─────────────────────────────────────────

方法A：使用我们提供的模型（推荐）
   a. 打开文件夹：第3步_AI模型/Whisper_Model/
   b. 将整个 Whisper_Model 文件夹
      复制到 C:\whisper-tiny\
   c. 确保路径为：
      C:\whisper-tiny\config.json
      C:\whisper-tiny\model.bin
      C:\whisper-tiny\tokenizer.json
      C:\whisper-tiny\vocabulary.txt

方法B：在线下载
   a. 双击运行：工具/下载语音模型.bat（download_whisper.bat）
   b. 等待下载完成（约75MB）


【第7步】测试安装
─────────────────────────────────────────

1. 确保LM Studio正在运行且服务器已启动

2. 双击运行：一键测试.bat

3. 检查所有项目是否显示 OK：
   ✅ Python: OK
   ✅ Libraries: OK
   ✅ TTS: OK
   ✅ LM Studio: OK

4. 如果有任何 FAILED，请检查对应步骤


【第8步】开始游戏！
─────────────────────────────────────────

每次游戏前的检查清单：
  ☑ LM Studio 已打开
  ☑ 模型已加载
  ☑ 服务器已启动（显示 running on port 1234）

然后正常启动GTA V即可！


=================================================
         游戏内操作指南
=================================================

靠近任何NPC时，屏幕上会显示互动菜单：

  G键 = 夸奖NPC
        （随机说一句好话，NPC会高兴地回应）

  H键 = 骂NPC
        （随机说一句坏话，NPC可能会生气或害怕）

  T键 = 打字对话
        （输入任何你想说的话，NPC会回应）

  J键 = 语音对话
        （按下后对着麦克风说话5秒，NPC会回应）

  F6  = 查看当前NPC的状态
        （性格、好感度、互动次数）

  F8  = 开关NPC语音
        （关闭后NPC只显示文字不发出声音）

  F9  = 保存NPC记忆
        （NPC会记住你之前的互动）


=================================================
         NPC性格说明
=================================================

每个NPC会随机获得一个性格：

  😊 Kind (友善)
     - 友好地和你打招呼
     - 被骂了会伤心但不会打你

  😠 Angry (暴躁)
     - 容易发怒
     - 被骂了可能会追你

  😨 Timid (胆小)
     - 容易害怕
     - 你一靠近就紧张

  😄 Funny (搞笑)
     - 说话很搞笑
     - 被吓到会说搞笑的话

  😐 Cold (冷漠)
     - 不太搭理你
     - 需要多次互动才会回应


=================================================
         常见问题 FAQ
=================================================

Q: 进游戏后按G/H/T/J没反应？
A: 1. 检查LM Studio是否在运行
   2. 检查是否靠近了NPC（8米内）
   3. 确认scripts文件夹中有dll文件

Q: NPC说话没有声音？
A: 1. 按F8确认语音已开启
   2. 检查电脑音量
   3. 确认Python和edge-tts已安装

Q: 按J语音输入没反应？
A: 1. 检查Windows麦克风权限
      设置 → 隐私 → 麦克风 → 允许
   2. 确认Whisper模型已安装到 C:\whisper-tiny\
   3. 运行一键测试.bat检查

Q: NPC头上显示方块字？
A: 这是正常的！GTA V的3D文字不支持中文
   中文对话会显示在屏幕右下角的通知栏

Q: 游戏很卡？
A: 1. 确保LM Studio只加载了一个模型
   2. 关闭其他占用CPU的程序

Q: 每次玩都要开LM Studio吗？
A: 是的，LM Studio是AI的大脑
   不开的话NPC无法思考